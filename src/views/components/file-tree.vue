<template>
  <el-tree ref="treeRef" :data="treeData" :props="treeNodeProps" empty-text="暂无数据">
    <template #default="{node,data}">
      <div class="file-node-wrapper">
        <svg v-show="data.isDir" t="1678956603245" class="icon" viewBox="0 0 1024 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" p-id="3293" width="100" height="100">
          <path
              d="M853.068468 915.604244 153.175123 915.604244c-53.357232 0-89.143273-42.561351-89.143273-95.91756L64.03185 203.559139c0-53.358255 35.786041-97.621365 89.143273-97.621365l258.389932 0c12.882402 0 24.102954 8.819876 27.128871 21.348214l28.628014 118.248148 385.745505 0c53.357232 0 104.383372 44.264133 104.383372 97.622388l0 476.531184C957.45184 873.042893 906.424676 915.604244 853.068468 915.604244zM153.175123 161.7755c-22.575158 0-33.3035 19.221784-33.3035 41.783639l0 616.127546c0 22.575158 10.728342 40.078811 33.3035 40.078811l699.892321 0c22.560832 0 48.544623-17.503653 48.544623-40.078811L901.612067 343.155501c0-22.561855-25.984814-41.783639-48.544623-41.783639L445.347462 301.371862c-12.882402 0-24.101931-8.820899-27.128871-21.348214l-28.628014-118.248148L153.175123 161.7755z"
              fill="#272636" p-id="3294"></path>
          <path
              d="M800.595372 817.886689 656.677589 817.886689c-7.715729 0-13.959943-6.244214-13.959943-13.959943s6.244214-13.959943 13.959943-13.959943l143.918807 0c13.81054 0 31.219026-1.500167 31.219026-32.064276l0-50.842968c0-7.715729 6.244214-13.959943 13.959943-13.959943 7.702426 0 13.959943 6.244214 13.959943 13.959943l0 50.842968C859.733261 798.255583 834.772776 817.886689 800.595372 817.886689z"
              fill="#272636" p-id="3295"></path>
          <path
              d="M839.25895 656.948253c-3.62762 0-7.254218-1.540076-9.911744-4.048199-2.508123-2.659573-4.049223-6.285147-4.049223-9.911744 0-3.6399 1.541099-7.266497 4.049223-9.911744 5.316076-5.16565 14.518668-5.16565 19.835767 0 2.5071 2.645247 4.033873 6.271844 4.033873 9.911744 0 3.626597-1.526773 7.252171-4.033873 9.911744C846.523401 655.408177 842.897827 656.948253 839.25895 656.948253z"
              fill="#272636" p-id="3296"></path>
          <path
              d="M880.032586 189.694363 531.040147 189.694363c-15.417131 0-27.918863-12.500709-27.918863-27.919886s12.501732-27.919886 27.918863-27.919886l348.992439 0c15.417131 0 27.918863 12.500709 27.918863 27.919886S895.45074 189.694363 880.032586 189.694363z"
              fill="#272636" p-id="3297"></path>
        </svg>
        <svg v-show="!data.isDir" t="1678956637940" class="icon" viewBox="0 0 1024 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" p-id="3440" width="100" height="100">
          <path
              d="M772.952802 957.48305 240.562403 957.48305c-54.298673 0-91.515297-46.732347-91.515297-98.998735L149.047106 158.599158c0-56.043411 41.415248-94.541213 91.515297-94.541213l280.788058 0c7.471159 0 14.613836 3.408633 19.862373 8.724709l319.572386 317.583079c5.167696 5.221932 14.164604 12.487406 14.164604 19.834744l0 448.28384C874.949824 915.413909 824.142671 957.48305 772.952802 957.48305zM240.562403 119.896694c-22.617114 0-35.676547 17.040095-35.676547 38.702464l0 699.885158c0 21.811772 11.955286 43.161009 35.676547 43.161009l532.389376 0c22.288632 0 46.159296-21.293979 46.159296-43.161009l0-436.818717L509.6817 119.896694 240.562403 119.896694z"
              fill="#272636" p-id="3441"></path>
          <path
              d="M841.79675 427.009304 590.195431 427.009304c-46.473451 0-78.195943-41.183981-78.195943-85.652775L511.999488 89.75521c0-5.630231-2.727111-10.715039 2.467191-12.882402 5.207605-2.139733 8.132214-1.007957 12.146645 2.958378L853.139076 403.983891c4.021593 3.967358 4.485151 9.556657 2.330068 14.791891C853.316108 424.009993 847.453586 427.009304 841.79675 427.009304zM539.918351 123.168204l0 218.188324c0 29.569456 18.7439 57.732889 50.27708 57.732889l217.615273 0L539.918351 123.168204z"
              fill="#272636" p-id="3442"></path>
          <path
              d="M402.053424 552.645722 290.375925 552.645722c-7.702426 0-13.959943-6.243191-13.959943-13.95892 0-7.716752 6.257517-13.959943 13.959943-13.959943l111.677499 0c7.715729 0 13.959943 6.243191 13.959943 13.959943C416.013367 546.402531 409.769153 552.645722 402.053424 552.645722z"
              fill="#272636" p-id="3443"></path>
          <path
              d="M597.502861 552.645722 457.905476 552.645722c-7.715729 0-13.973246-6.243191-13.973246-13.95892 0-7.716752 6.257517-13.959943 13.973246-13.959943l139.596362 0c7.715729 0 13.959943 6.243191 13.959943 13.959943C611.461781 546.402531 605.21859 552.645722 597.502861 552.645722z"
              fill="#272636" p-id="3444"></path>
          <path
              d="M709.179336 552.645722l-55.838749 0c-7.715729 0-13.959943-6.243191-13.959943-13.95892 0-7.716752 6.244214-13.959943 13.959943-13.959943l55.838749 0c7.715729 0 13.959943 6.243191 13.959943 13.959943C723.13928 546.402531 716.895065 552.645722 709.179336 552.645722z"
              fill="#272636" p-id="3445"></path>
          <path
              d="M346.214674 622.444415l-55.838749 0c-7.702426 0-13.959943-6.244214-13.959943-13.959943s6.257517-13.959943 13.959943-13.959943l55.838749 0c7.715729 0 13.959943 6.244214 13.959943 13.959943S353.930403 622.444415 346.214674 622.444415z"
              fill="#272636" p-id="3446"></path>
          <path
              d="M513.744225 622.444415 402.053424 622.444415c-7.702426 0-13.959943-6.244214-13.959943-13.959943s6.257517-13.959943 13.959943-13.959943L513.744225 594.524528c7.715729 0 13.959943 6.244214 13.959943 13.959943S521.459954 622.444415 513.744225 622.444415z"
              fill="#272636" p-id="3447"></path>
          <path
              d="M709.179336 622.444415 569.582975 622.444415c-7.716752 0-13.960966-6.244214-13.960966-13.959943s6.244214-13.959943 13.960966-13.959943l139.596362 0c7.715729 0 13.959943 6.244214 13.959943 13.959943S716.895065 622.444415 709.179336 622.444415z"
              fill="#272636" p-id="3448"></path>
          <path
              d="M429.972287 706.202027 290.375925 706.202027c-7.702426 0-13.959943-6.243191-13.959943-13.959943 0-7.715729 6.257517-13.959943 13.959943-13.959943l139.596362 0c7.716752 0 13.959943 6.244214 13.959943 13.959943C443.93223 699.959859 437.689039 706.202027 429.972287 706.202027z"
              fill="#272636" p-id="3449"></path>
          <path
              d="M625.421724 706.202027 485.824339 706.202027c-7.715729 0-13.959943-6.243191-13.959943-13.959943 0-7.715729 6.244214-13.959943 13.959943-13.959943l139.596362 0c7.716752 0 13.959943 6.244214 13.959943 13.959943C639.380644 699.959859 633.138476 706.202027 625.421724 706.202027z"
              fill="#272636" p-id="3450"></path>
          <path
              d="M709.179336 706.202027 681.25945 706.202027c-7.714705 0-13.95892-6.243191-13.95892-13.959943 0-7.715729 6.244214-13.959943 13.95892-13.959943l27.919886 0c7.715729 0 13.959943 6.244214 13.959943 13.959943C723.13928 699.959859 716.895065 706.202027 709.179336 706.202027z"
              fill="#272636" p-id="3451"></path>
          <path
              d="M346.214674 776.007883l-55.838749 0c-7.702426 0-13.959943-6.244214-13.959943-13.960966 0-7.714705 6.257517-13.95892 13.959943-13.95892l55.838749 0c7.715729 0 13.959943 6.244214 13.959943 13.95892C360.174618 769.764692 353.930403 776.007883 346.214674 776.007883z"
              fill="#272636" p-id="3452"></path>
          <path
              d="M499.784282 776.007883l-97.730858 0c-7.702426 0-13.959943-6.244214-13.959943-13.960966 0-7.714705 6.257517-13.95892 13.959943-13.95892l97.730858 0c7.702426 0 13.959943 6.244214 13.959943 13.95892C513.744225 769.764692 507.487731 776.007883 499.784282 776.007883z"
              fill="#272636" p-id="3453"></path>
        </svg>
        <p>{{ node.label }}</p>
        <div class="node-more-icon" @click.stop>
          <el-popover placement="right" width="200px" trigger="click">
            <template #reference>
              <svg t="1678956992242" class="icon"
                   viewBox="0 0 1024 1024"
                   version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3724" width="100" height="100">
                <path
                    d="M85.333333 448h149.333334v149.333333H85.333333zM448 448h149.333333v149.333333h-149.333333zM789.333333 448h149.333334v149.333333h-149.333334z"
                    fill="#090909" p-id="3725"></path>
              </svg>
            </template>
            <div class="node-pop-wrapper">
              <h3 class="title">请选择操作</h3>
              <div class="actions">
                <el-button @click="clickedNodeAction(0,data)" type="primary" style="margin-bottom: 12px">删除当前目录</el-button>
                <el-button @click="clickedNodeAction(1,data)" type="primary" style="margin-bottom: 12px">新增子目录</el-button>
                <el-button @click="clickedNodeAction(2, data)" type="primary" style="margin-bottom: 12px">上传图形</el-button>
              </div>
            </div>
          </el-popover>
        </div>

      </div>
    </template>
  </el-tree>
</template>
<script setup lang="ts">
import {ref} from "vue";
import { ElMessageBox } from "element-plus"
const treeRef = ref()
const treeNodeProps = {
  children: 'children',
  label: 'name',
}
const treeData = ref(new Array<NodeModel>())
// 第二个参数 是否显示文件类节点,如果传入false,则仅显示到文件目录, 不显示具体图元或图
const setTreeData = (jsonTree: NodeModel[], showFileNode?:boolean) => {
  treeData.value = jsonTree
}
defineExpose({
  'setTreeData': setTreeData
})
const clickedNodeAction = (action:number, data:NodeModel) => {
  if (action === 0) {
    ElMessageBox.confirm("删除当前目录节点将同时删除本节点下的所有元素","删除当前目录", {
      confirmButtonText:"确定",
      cancelButtonText:"取消",
      type: "warning"
    }).then(()=>{
      deleteNode(data.uuid!)
    })
  }
}

const deleteNode = (uuid:string) => {

}

</script>
<style>
.node-pop-wrapper .actions {
  display: flex;
  flex-direction: column;
  flex-wrap: nowrap;
  align-items: center;
  justify-content: center;
  margin-top: 24px;
}
.node-pop-wrapper {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-around;
}
.file-node-wrapper .node-more-icon {
  position: absolute;
  right: 4px;
  width: 22px;
  margin: 8px;
}

.file-node-wrapper p {
  margin-left: 4px;
}

.file-node-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  flex-wrap: nowrap;
  width: 100%;
  font-size: 1rem;
  color: #333;
}
</style>